<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>订单发货</title>
    <script src="__STATIC__/js/public/rem.js" type="text/javascript" charset="utf-8"></script>
	<link rel="stylesheet" href="__STATIC__/css/public_lb/public.css" />
	<link rel="stylesheet" type="text/css" href="__STATIC__/css/user_zp/order_send.css"/>
</head>
<body>
    <div class="wrapper">
    	<!--public head-->
        <div class="lb_headWrap topBox_backgroundColor">
            <p class="lb_headWrap_return" data-num="1" onclick="returnFun()">
                <img class="lb_headWrap_return_img" src="__STATIC__/images/public_lb/returnImg666_lb.png"/>
            </p>
            <span>订单发货</span>
        </div>
        <!--内容-->
        <div class="content">
			<if condition="count($order_list) eq 0">
				<!--没有内容时-s--->
				<div class="comment_con p">
					<div class="none" style="text-align: center;margin: 4.26667rem 0;font-size: .4733rem;color: #777777;">
						<img src="__STATIC__/images/none3.png">
						<br>
						暂无数据!
					</div>
				</div>
				<!-- 没有内容时-e- -->
			</if>
			<volist name="order_list" id="order">
				<input name="order_id" value="{$order['order_id']}" type="hidden"/>
				<div class="box_wrap">
					<div class="list_wrap">
						<div class="img">
							<img src="{$order.users.head_pic}" />
						</div>

						<div class="ziti">

							<div class="idnum">
								<span class="nu">ID:{$order.users.user_id}</span>
								<span>手机号:{$order.mobile}</span>
							</div>

							<div class="idnum">
								<span>订单编号:</span>
								<span>{$order.order_sn}</span>
							</div>

							<div class="order">
								<!--<div class="stock">-->
									<!--<span>库存:</span>-->
									<!--<span>6962</span>-->
								<!--</div>-->
								<div class="hue">
									<span>发货数量:</span>
									<span>{$order.count_goods_num}</span>
								</div>
							</div>
							<div class="num">
								<span>应收金额:</span>
								<span>{$order.order_amount}</span>
							</div>
							<!--查看详情按钮-->
							<div class="view">
								<div class="det">查看详情</div>
								<div class="icon"></div>
							</div>
						</div>
					</div>
					<!--下拉列表-->
					<div class="down_list">
						<div class="item_cont">

							<volist name="order.order_goods" id="goods">
								<div class="item">
									<div class="imgs">
										<img src="{$goods[goods_id]|goods_thum_images=200,200}" />
									</div>

									<div class="right">
										<p class="explain">{$goods[goods_name]|getSubstr=0,20}</p>
										<div class="cost">单价：{$goods[goods_price]}</div>
										<div class="money">
											<span>金额：{$goods[member_goods_price]}</span>
											<span>数量：{$goods[goods_num]}</span>
										</div>
									</div>
								</div>
							</volist>

							<!--总数-->
							<div class="amount">
								<span>总金额：{$order.total_amount}</span>
								<span>总件数：{$order.count_goods_num}</span>
							</div>
							<!--按钮-->
							<div class="btn_wrap">
								<!--取消-->
								<a class="call_btn" data-id="{$order[order_id]}" data-url="{:U('order_action')}" onclick="delfunc('invalid',this,'要取消该订单吗，取消订单不会扣除你库存')">取消订单</a>
								<!--确定-->
								<a class="make_btn" data-id="{$order[order_id]}" data-url="{:U('order_action')}" onclick="delfunc('confirm',this,'请确认已收到资金  点击确认后您的库存将会减少')">确定发货</a>
							</div>
						</div>
					</div>
				</div>
			</volist>
        </div>
    </div> 
    <!--弹框-->
    <div class="popup_wrap">
    	<div class="up">
    		<p class="pop">请确认已收到资金  点击确认后您的库存将会减少</p>
    		<!--按钮-->
        	<div class="btn_app">
        		<!--确定-->
        		<a class="ma_btn">确定</a>
        		<!--取消-->
        		<a class="ca_btn">取消</a>
        	</div>
    	</div>
    </div>
    
    <script src="__STATIC__/js/public/jquery-1.8.3.min.js"></script>
	<script src="__STATIC__/js/public/public_lb.js"></script>
	<script type="text/javascript" src="__PUBLIC__/static/js/layer/layer.js"></script><!-- 弹窗js 参考文档 http://layer.layui.com/-->
	<script>
		$(function (){

			//下拉框
			$('.view').click(function (){
				$(this).parents(".box_wrap").find(".down_list").toggle();
			});

		})

		function delfunc(type,obj,content){

			layer.confirm(content, {
						btn: ['确定','取消'] //按钮
					}, function(){
						// 确定
						$.ajax({
							type : 'post',
							url : $(obj).attr('data-url'),
							data : {act:type,order_id:$(obj).attr('data-id')},
							dataType : 'json',
							success : function(data){
								layer.closeAll();
								if(data.status==1){
									layer.msg(data.msg, {icon: 1},function(index){
										location.href=data.url;

										layer.close(index);

									});
									$(obj).parent().parent().parent('tr').remove();
								}else{
									layer.msg(data.msg, {icon: 2,time: 2000});
								}
							}
						})
					}, function(index){
						layer.close(index);
					}
			);
		}

	</script>
</body>
</html>